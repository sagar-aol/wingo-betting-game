<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WinGO - Enhanced Betting Game 123</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(135deg, #0f0c29, #1a1a2e, #16213e);
        color: #f0f0f0;
        min-height: 100vh;
        padding: 20px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        overflow-x: hidden;
      }

      .game-container {
        width: 100%;
        max-width: 1400px;
        display: grid;
        grid-template-columns: 1fr 2fr 1fr;
        gap: 20px;
        height: 70vh;
        /* margin-bottom: 60px; */
      }

      .game-header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        text-align: center;
        z-index: 10;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px;
        padding: 5px 0 10px;
        background: rgba(10, 10, 25, 0.2);
        backdrop-filter: blur(5px);
        border-radius: 0 0 50% 50%;
      }

      .game-title {
        font-size: 3.2rem;
        font-weight: 800;
        background: linear-gradient(45deg, #ff6b6b, #00b894, #00c8ff);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 0 20px rgba(0, 200, 255, 0.3);
        letter-spacing: 2px;
      }

      .info-btn {
        background: rgba(40, 40, 60, 0.8);
        border: none;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        color: #4ecdc4;
        font-size: 1.5rem;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
        transition: all 0.3s ease;
      }

      .info-btn:hover {
        transform: scale(1.1);
        background: rgba(60, 60, 100, 0.9);
        color: #00c8ff;
      }

      .history-panel {
        background: rgba(20, 20, 40, 0.85);
        border-radius: 15px;
        padding: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        overflow: hidden;
        display: flex;
        flex-direction: column;
        min-width: 325px;
      }

      .panel-title {
        font-size: 0.8rem;
        color: #8d99ae;
        display: flex;
        align-items: center;
        gap: 10px;
        padding-bottom: 12px;
        border-bottom: 1px solid #2d4059;
      }
      .empty-history {
        font-size: 0.7rem;
        color: #8d99ae;
      }

      .history-content {
        flex: 1;
        overflow-y: auto;
        padding: 10px;
      }

      /* Custom scrollbar */
      .history-content::-webkit-scrollbar {
        width: 6px;
      }

      .history-content::-webkit-scrollbar-track {
        background: rgba(30, 30, 50, 0.3);
        border-radius: 3px;
      }

      .history-content::-webkit-scrollbar-thumb {
        background: #4ecdc4;
        border-radius: 3px;
      }

      .history-content::-webkit-scrollbar-thumb:hover {
        background: #00b894;
      }

      .history-row {
        padding: 8px 0;
        border-bottom: 1px solid rgba(45, 64, 89, 0.3);
        transition: all 0.3s ease;
        cursor: pointer;
        position: relative;
      }

      .history-row.new-entry {
        transform: translateX(-10px);
        animation: slideIn 0.5s ease forwards;
      }

      @keyframes slideIn {
        0% {
          transform: translateX(-20px);
          opacity: 0;
        }
        100% {
          transform: translateX(0);
          opacity: 1;
        }
      }

      .round-label {
        font-size: 0.9rem;
        color: #4ecdc4;
        margin-bottom: 5px;
        font-weight: bold;
        display: none;
      }

      .numbers-row {
        display: flex;
        gap: 3.3px;
        /*flex-wrap: wrap;*/
      }

      .number-cell {
        width: 25px;
        height: 25px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        font-weight: bold;
        font-size: 0.9rem;
        color: gray;
        background: rgba(40, 40, 60, 0.6);
        transition: all 0.3s ease;
      }

      .number-cell.win.big {
        background: linear-gradient(145deg, #00b894, #007a5e);
        box-shadow: 0 0 8px rgba(0, 184, 148, 0.5);
        color: black;
        font-size: 1.1rem;
        font-weight: 800;
      }

      .number-cell.win.small {
        background: linear-gradient(145deg, #ff6b6b, #c0392b);
        color: black;
        box-shadow: 0 0 8px rgba(255, 107, 107, 0.5);
        font-size: 1.1rem;
        font-weight: 800;
      }

      .player-history-item {
        padding: 5px;
        margin-bottom: 8px;
        border-radius: 8px;
        background: rgba(40, 40, 60, 0.6);
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.3s ease;
        cursor: pointer;
        position: relative;
        font-size: 0.8rem;
        font-weight: 800;
        text-transform: capitalize;
      }

      .player-history-item.new-entry {
        background: rgba(78, 205, 196, 0.1);
        transform: translateX(10px);
        animation: slideInRight 0.5s ease forwards;
      }

      @keyframes slideInRight {
        0% {
          transform: translateX(20px);
          opacity: 0;
        }
        100% {
          transform: translateX(0);
          opacity: 1;
        }
      }

      .history-info {
        display: flex;
        flex-direction: column;
      }

      .history-type {
        font-weight: bold;
      }

      .history-amount {
        font-weight: bold;
      }

      .history-status {
        font-weight: bold;
        padding: 4px 8px;
        border-radius: 5px;
        font-size: 0.8rem;
        text-align: center;
        min-width: 65px;
        letter-spacing: 2px;
      }

      .status-pending {
        background: rgba(155, 89, 182, 0.3);
        color: #9b59b6;
      }

      .status-win {
        background: rgba(0, 184, 148, 0.3);
        color: #00b894;
      }

      .status-loss {
        background: rgba(255, 107, 107, 0.3);
        color: #ff6b6b;
      }

      .main-game-area {
        background: rgba(20, 20, 40, 0.85);
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 20px;
        flex-direction: column;
        position: relative;
        overflow: hidden;
      }

      .main-game-area::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: linear-gradient(to right, #00b894, #ff6b6b);
      }

      .wallet-section {
        display: flex;
        justify-content: space-between;
        align-self: flex-start;
      }

      .wallet-info {
        display: flex;
        flex-direction: column;
        position: relative;
        user-select: none;
      }

      .wallet-label {
        font-size: 0.8rem;
        color: #8d99ae;
      }

      .wallet-amount {
        font-size: 1.3rem;
        font-weight: bold;
        color: #4caf50;
        cursor: pointer;
        position: relative;
      }

      .tooltip {
        position: absolute;
        top: -30px;
        left: 0;
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-size: 0.8rem;
        white-space: nowrap;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 1000;
      }

      .wallet-amount:hover .tooltip {
        opacity: 1;
      }

      .timer-controls {
        display: flex;
        justify-content: center;
        gap: 10px;
      }

      .timer-btn {
        background: rgba(40, 40, 60, 0.9);
        border: 2px solid #2d4059;
        border-radius: 8px;
        color: #f0f0f0;
        padding: 6px 12px;
        font-size: 0.7rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .timer-btn:hover {
        background: rgba(60, 60, 100, 0.9);
      }

      .timer-btn.active {
        background: rgba(0, 184, 148, 0.4);
        border-color: #00b894;
        color: #00b894;
        box-shadow: 0 0 10px rgba(0, 184, 148, 0.4);
      }

      .timer-section {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 10px 0;
        position: relative;
      }

      .timer-display {
        font-size: 3rem;
        font-weight: bold;
        background: rgba(30, 30, 50, 0.95);
        padding: 20px 50px;
        border-radius: 15px;
        box-shadow: 0 0 25px rgba(0, 200, 255, 0.3);
        color: #00c8ff;
        text-shadow: 0 0 15px rgba(0, 200, 255, 0.7);
        font-family: "Courier New", monospace;
        border: 3px solid #2a9d8f;
        transition: all 0.5s ease;
      }

      .timer-critical {
        animation: pulse 1s infinite;
        box-shadow: 0 0 25px rgba(255, 107, 107, 0.5);
        color: #ff6b6b;
        text-shadow: 0 0 15px rgba(255, 107, 107, 0.7);
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.03);
        }
        100% {
          transform: scale(1);
        }
      }

      .bet-buttons {
        display: flex;
        justify-content: center;
        gap: 25px;
      }

      .bet-btn {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        font-size: 1.5rem;
        font-weight: bold;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4);
        position: relative;
        overflow: hidden;
        z-index: 2;
      }

      .bet-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 0 25px rgba(255, 255, 255, 0.2);
      }

      .big-btn {
        background: linear-gradient(145deg, #00b894, #007a5e, #00c8ff);
        color: #fff;
      }

      .small-btn {
        background: linear-gradient(145deg, #ff6b6b, #c0392b, #00c8ff);
        color: #fff;
      }

      .bet-btn span {
        font-size: 0.8rem;
        margin-top: 6px;
        font-weight: normal;
        opacity: 0.9;
      }

      .dealer-info {
        text-align: right;
        margin-left: auto;
        margin-bottom: -10px;
        padding: 10px;
      }

      .dealer-label {
        font-size: 0.7rem;
        color: #f39c12;
        margin-bottom: 3px;
      }

      .dealer-amount {
        font-size: 1rem;
        font-weight: bold;
      }

      .dealer-positive {
        color: #4caf50;
      }

      .dealer-negative {
        color: #ff6b6b;
      }

      .betting-modal {
        position: fixed;
        bottom: -1000%;
        left: 50%;
        transform: translateX(-50%);
        width: 90vw;
        max-width: 500px;
        background: rgba(15, 15, 35, 0.98);
        border-top-left-radius: 20px;
        border-top-right-radius: 20px;
        padding: 5px 20px 30px;
        box-shadow: 0 -8px 30px rgba(0, 0, 0, 0.7);
        transition: bottom 0.4s ease;
        z-index: 1000;
        border: 2px solid #2d4059;
        backdrop-filter: blur(10px);
        max-height: 70vh;
        overflow-y: auto;
      }

      .modal-open {
        bottom: 0;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-bottom: 12px;
        border-bottom: 2px solid #2d4059;
      }

      .modal-title {
        font-size: 1.2rem;
        font-weight: bold;
        color: #4ecdc4;
        text-shadow: 0 0 8px rgba(78, 205, 196, 0.4);
      }

      .close-modal {
        background: none;
        border: none;
        color: #ff6b6b;
        font-size: 1.6rem;
        cursor: pointer;
        transition: transform 0.3s ease;
      }

      .close-modal:hover {
        transform: rotate(90deg);
      }

      .amount-section,
      .quantity-section {
        margin: 12px 0;
      }

      .section-title {
        font-size: 0.7rem;
        margin-bottom: 10px;
        color: #8d99ae;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .amount-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
        margin-bottom: 10px;
      }

      .amount-btn {
        padding: 10px 6px;
        background: rgba(40, 40, 60, 0.9);
        border: 2px solid #2d4059;
        border-radius: 10px;
        color: gray;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .amount-btn:hover {
        background: rgba(60, 60, 100, 0.9);
        transform: translateY(-3px);
      }

      .amount-btn.active {
        background: rgba(0, 184, 148, 0.4);
        border-color: #00b894;
        color: #00b894;
        box-shadow: 0 0 10px rgba(0, 184, 148, 0.4);
      }

      .adjust-buttons {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 8px;
        margin-bottom: 10px;
      }

      .adjust-btn {
        padding: 10px 6px;
        background: rgba(40, 40, 60, 0.9);
        border: 2px solid #2d4059;
        border-radius: 10px;
        color: #f0f0f0;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .adjust-btn:hover {
        background: rgba(60, 60, 100, 0.9);
        transform: translateY(-3px);
      }

      .adjust-btn.positive {
        background: rgba(0, 184, 148, 0.2);
        color: #00b894;
      }

      .adjust-btn.negative {
        background: rgba(255, 107, 107, 0.2);
        color: #ff6b6b;
      }

      .quantity-controls {
        display: flex;
        gap: 20px;
        align-items: center;
        justify-content: center;
      }

      .quantity-btn {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: rgba(40, 40, 60, 0.9);
        border: 2px solid #2d4059;
        color: #f0f0f0;
        font-size: 1.3rem;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        user-select: none;
      }

      .quantity-btn:hover {
        background: rgba(60, 60, 100, 0.9);
      }

      .quantity-input {
        width: 50%;
        padding: 10px;
        text-align: center;
        background: rgba(40, 40, 60, 0.9);
        border: 2px solid #2d4059;
        border-radius: 10px;
        color: #f0f0f0;
        font-weight: bold;
        appearance: textfield;
        -moz-appearance: textfield;
      }

      .quantity-input::-webkit-outer-spin-button,
      .quantity-input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }

      .multiplier-section {
        margin: 12px 0;
      }

      .multiplier-grid {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 8px;
      }

      .multiplier-btn {
        color: #bbbbbb;
        padding: 3px;
        background: rgba(40, 40, 60, 0.9);
        border: 2px solid #2d4059;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .multiplier-btn:hover {
        background: rgba(60, 60, 100, 0.9);
        transform: translateY(-3px);
      }

      .multiplier-btn.active {
        background: rgba(155, 89, 182, 0.4);
        border-color: #9b59b6;
        color: #9b59b6;
        box-shadow: 0 0 10px rgba(155, 89, 182, 0.4);
      }

      .bet-summary {
        background: rgba(40, 40, 60, 0.9);
        border-radius: 10px;
        padding: 10px;
        margin: 12px 0;
        border: 2px solid #2d4059;
      }

      .total-amount {
        font-size: 1.1rem;
        font-weight: bold;
        color: #f39c12;
        text-align: center;
        text-shadow: 0 0 6px rgba(243, 156, 18, 0.3);
      }

      .modal-buttons {
        display: flex;
        gap: 10px;
      }

      .modal-btn {
        flex: 1;
        padding: 12px;
        border-radius: 10px;
        border: none;
        font-weight: bold;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      }

      .modal-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
      }

      .modal-btn i {
        font-size: 1.1rem;
      }

      .confirm-btn {
        background: linear-gradient(to right, #00b894, #00876a);
        color: white;
      }

      .cancel-btn {
        background: rgba(120, 120, 120, 0.3);
        color: #ddd;
        border: 2px solid #555;
      }

      .toast {
        position: fixed;
        top: 0px;
        left: 50%;
        transform: translateX(-50%) translateY(-500vh);
        background: rgba(40, 40, 60, 0.95);
        color: white;
        padding: 15px 25px;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.9);
        font-weight: bold;
        z-index: 2000;
        transition: transform 0.4s ease;
      }

      .toast.show {
        transform: translateX(-50%) translateY(1vh);
      }

      .detail-tooltip {
        position: absolute;
        background: rgba(10, 15, 30, 0.95);
        border: 1px solid #2d4059;
        border-radius: 8px;
        padding: 15px;
        width: 280px;
        z-index: 1000;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        backdrop-filter: blur(5px);
      }

      .detail-tooltip.show {
        opacity: 1;
        pointer-events: all;
      }

      /* Ensure tooltip stays within viewport */
      .detail-tooltip {
        max-width: 90vw;
        max-height: 80vh;
        overflow: auto;
        box-sizing: border-box;
      }

      .tooltip-header {
        font-size: 1.1rem;
        color: #4ecdc4;
        margin-bottom: 10px;
        padding-bottom: 8px;
        border-bottom: 1px solid #2d4059;
      }

      .tooltip-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        font-size: 0.9rem;
      }

      .tooltip-label {
        color: #8d99ae;
      }

      .tooltip-value {
        font-weight: bold;
      }

      .tooltip-value.positive {
        color: #00b894;
      }

      .tooltip-value.negative {
        color: #ff6b6b;
      }

      .rules-modal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(10, 10, 20, 0.95);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 3000;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.4s ease;
        padding: 20px;
      }

      .rules-modal.show {
        opacity: 1;
        pointer-events: all;
      }

      .rules-content {
        background: rgba(20, 20, 40, 0.95);
        border-radius: 15px;
        padding: 30px;
        max-width: 800px;
        width: 100%;
        max-height: 90vh;
        overflow-y: auto;
        position: relative;
      }

      .close-rules {
        position: absolute;
        top: 20px;
        right: 20px;
        background: none;
        border: none;
        color: #ff6b6b;
        font-size: 1.8rem;
        cursor: pointer;
        transition: transform 0.3s ease;
      }

      .close-rules:hover {
        transform: rotate(90deg);
      }

      .rules-title {
        font-size: 2rem;
        margin-bottom: 20px;
        color: #4ecdc4;
        text-align: center;
        text-shadow: 0 0 10px rgba(78, 205, 196, 0.5);
      }

      .rules-section {
        margin-bottom: 25px;
      }

      .section-header {
        font-size: 1.4rem;
        color: #00b894;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .rules-list {
        padding-left: 30px;
      }

      .rules-list li {
        margin-bottom: 12px;
        line-height: 1.6;
      }

      .highlight {
        color: #f39c12;
        font-weight: bold;
      }

      .negative {
        color: #ff6b6b;
      }

      .positive {
        color: #00b894;
      }

      /* Sound Toggle Inside Rules Modal */
      .sound-toggle-container {
        display: flex;
        justify-content: center;
        margin-top: 20px;
        padding: 10px;
      }

      .sound-toggle {
        background: rgba(40, 40, 60, 0.9);
        border: 2px solid #4ecdc4;
        border-radius: 50px;
        padding: 10px 15px;
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .sound-toggle:hover {
        background: rgba(60, 60, 100, 0.9);
        transform: scale(1.05);
      }

      .sound-toggle.active {
        background: rgba(0, 184, 148, 0.4);
      }

      .sound-toggle i {
        font-size: 1.2rem;
        color: #4ecdc4;
      }

      .sound-toggle span {
        font-size: 0.9rem;
        font-weight: 600;
      }

      /* History Carousel for Mobile */
      .history-carousel {
        display: none;
        margin-top: 20px;
        position: relative;
        width: 100%;
        max-width: 330px;
        margin: 20px auto 0;
      }

      .carousel-header {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-bottom: 10px;
      }

      .carousel-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.3);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .carousel-dot.active {
        background: #4ecdc4;
        transform: scale(1.2);
      }

      .carousel-inner {
        display: flex;
        overflow-x: auto;
        scroll-snap-type: x mandatory;
        scroll-behavior: smooth;
        -webkit-overflow-scrolling: touch;
        border-radius: 15px;
        background: rgba(20, 20, 40, 0.85);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      }

      .carousel-inner::-webkit-scrollbar {
        display: none;
      }

      .carousel-item {
        scroll-snap-align: start;
        flex: 0 0 100%;
        padding: 15px;
        min-height: 200px;
      }

      /* Responsive adjustments */
      @media (max-width: 1200px) {
        .game-container {
          grid-template-columns: 1fr;
          height: auto;
          margin-top: 5rem;
        }

        .history-panel {
          /* height: 250px; */
          display: none;
        }

        .timer-display {
          font-size: 2rem;
          padding: 15px 40px;
        }
        /* Show carousel on mobile */
        .history-carousel {
          display: block;
        }
      }

      @media (max-width: 768px) {
        .amount-grid {
          grid-template-columns: repeat(4, 1fr);
        }

        .timer-display {
          font-size: 2.5rem;
          padding: 12px 35px;
        }

        .adjust-buttons {
          grid-template-columns: repeat(3, 1fr);
        }

        .bet-buttons {
          gap: 15px;
        }

        .game-title {
          font-size: 2.5rem;
        }

        .game-header {
          gap: 10px;
        }

        /* Mobile modal adjustments */
        .betting-modal {
          max-height: 50vh;
          padding: 5px 15px 20px;
        }

        .modal-title {
          font-size: 1rem;
        }

        .amount-grid,
        .multiplier-grid,
        .adjust-buttons {
          gap: 6px;
        }

        .amount-btn,
        .adjust-btn,
        .multiplier-btn {
          padding: 8px 4px;
          font-size: 0.8rem;
        }

        .quantity-controls {
          gap: 10px;
        }

        .quantity-btn {
          width: 35px;
          height: 35px;
          font-size: 1.1rem;
        }

        .quantity-input {
          width: 40%;
          padding: 8px;
        }

        .total-amount {
          font-size: 1rem;
        }

        .modal-btn {
          padding: 10px;
          font-size: 0.9rem;
        }

        /* Hide side panels on mobile */
        .history-panel {
          display: none;
        }

        /* Compact rules modal */
        .rules-content {
          padding: 20px;
        }

        .rules-title {
          font-size: 1.8rem;
          margin-bottom: 15px;
        }

        .section-header {
          font-size: 1.2rem;
        }

        .rules-list li {
          font-size: 0.9rem;
        }
      }

      @media (max-width: 480px) {
        .bet-btn {
          width: 85px;
          height: 85px;
          font-size: 1.6rem;
        }

        .timer-display {
          font-size: 2rem;
          padding: 10px 25px;
        }

        .multiplier-grid {
          grid-template-columns: repeat(3, 1fr);
        }

        .rules-content {
          padding: 15px;
        }

        .timer-controls {
          flex-wrap: wrap;
        }

        /* Mobile modal adjustments */
        .betting-modal {
          max-height: 45vh;
          padding: 5px 10px 15px;
        }

        .modal-title {
          font-size: 0.9rem;
        }

        .amount-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        .adjust-buttons {
          grid-template-columns: repeat(2, 1fr);
        }

        .multiplier-grid {
          grid-template-columns: repeat(3, 1fr);
        }

        .amount-btn,
        .adjust-btn,
        .multiplier-btn {
          padding: 6px 3px;
          font-size: 0.75rem;
        }

        .quantity-btn {
          width: 30px;
          height: 30px;
          font-size: 1rem;
        }

        .modal-btn {
          padding: 8px;
          font-size: 0.8rem;
        }

        /* Compact rules modal */
        .rules-title {
          font-size: 1.5rem;
        }

        .section-header {
          font-size: 1.1rem;
        }

        .rules-list {
          padding-left: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div class="toast" id="toast">Bet placed successfully!</div>
    <div class="detail-tooltip" id="detail-tooltip">
      <div class="tooltip-header">Bet Details</div>
      <div class="tooltip-row">
        <div class="tooltip-label">Round:</div>
        <div class="tooltip-value" id="tooltip-round">1</div>
      </div>
      <div class="tooltip-row">
        <div class="tooltip-label">Bet Type:</div>
        <div class="tooltip-value" id="tooltip-type">BIG</div>
      </div>
      <div class="tooltip-row">
        <div class="tooltip-label">Bet Amount:</div>
        <div class="tooltip-value" id="tooltip-amount">₹100.00</div>
      </div>
      <div class="tooltip-row">
        <div class="tooltip-label">Outcome:</div>
        <div class="tooltip-value" id="tooltip-outcome">Win</div>
      </div>
      <div class="tooltip-row">
        <div class="tooltip-label">Payout:</div>
        <div class="tooltip-value positive" id="tooltip-payout">₹196.00</div>
      </div>
      <div class="tooltip-row">
        <div class="tooltip-label">Fee Deducted:</div>
        <div class="tooltip-value negative" id="tooltip-fee">₹4.00</div>
      </div>
      <div class="tooltip-row">
        <div class="tooltip-label">Net Profit:</div>
        <div class="tooltip-value positive" id="tooltip-profit">₹96.00</div>
      </div>
    </div>

    <div class="flex">
      <div class="game-header">
        <h1 class="game-title">WinGO</h1>
        <button class="info-btn" id="info-btn">
          <i class="fas fa-info"></i>
        </button>
      </div>

      <div class="game-container">
        <!-- Left Panel - Game History -->
        <div class="history-panel game-history-panel">
          <div class="panel-title"><i class="fas fa-history"></i> Game History</div>
          <div class="history-content" id="game-history">
            <div class="empty-history">Loading game history...</div>
          </div>
        </div>

        <!-- Main Game Area -->
        <div class="main-game-area">
          <div class="wallet-section">
            <div class="wallet-info">
              <div class="wallet-label">Wallet Balance</div>
              <div class="wallet-amount" id="wallet-amount">
                ₹5,000.00
                <div class="tooltip">Double click to add funds</div>
              </div>
            </div>
          </div>

          <div class="timer-controls">
            <button class="timer-btn" data-time="10">10s</button>
            <button class="timer-btn active" data-time="30">30s</button>
            <button class="timer-btn" data-time="60">1min</button>
            <button class="timer-btn" data-time="180">3min</button>
            <button class="timer-btn" data-time="300">5min</button>
          </div>

          <div class="timer-section">
            <div class="timer-display" id="timer">00:30</div>
          </div>

          <div class="bet-buttons">
            <button class="bet-btn small-btn" id="small-btn">
              Small
              <span>0-4</span>
            </button>
            <button class="bet-btn big-btn" id="big-btn">
              Big
              <span>5-9</span>
            </button>
          </div>

          <!-- Dealer Earnings -->
          <div class="dealer-info">
            <div class="dealer-label">Dealer Balance (2% Fee + Losses)</div>
            <div class="dealer-amount" id="dealer-amount">₹0.00</div>
          </div>
        </div>

        <!-- Right Panel - Player History -->
        <div class="history-panel player-history-panel">
          <div class="panel-title"><i class="fas fa-user"></i> Player History</div>
          <div class="history-content" id="player-history">
            <div class="empty-history">No bets placed yet</div>
          </div>
        </div>
      </div>
    </div>

    <!-- History Carousel for Mobile -->
    <div class="history-carousel">
      <div class="carousel-header">
        <div class="carousel-dot active" data-index="0"></div>
        <div class="carousel-dot" data-index="1"></div>
      </div>
      <div class="carousel-inner" id="carousel-inner">
        <div class="carousel-item">
          <div class="panel-title"><i class="fas fa-history"></i> Game History</div>
          <div class="history-content" id="mobile-game-history">
            <div class="empty-history">Loading game history...</div>
          </div>
        </div>
        <div class="carousel-item">
          <div class="panel-title"><i class="fas fa-user"></i> Player History</div>
          <div class="history-content" id="mobile-player-history">
            <div class="empty-history">No bets placed yet</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Betting Modal -->
    <div class="betting-modal" id="betting-modal">
      <div class="modal-header">
        <div class="modal-title" id="modal-bet-type">Select Big</div>
        <button class="close-modal" id="close-modal"><i class="fas fa-times"></i></button>
      </div>

      <div class="amount-section">
        <div class="section-title"><i class="fas fa-rupee-sign"></i> Base Amount</div>
        <div class="amount-grid">
          <button class="amount-btn" data-amount="1">₹1</button>
          <button class="amount-btn" data-amount="10">₹10</button>
          <button class="amount-btn" data-amount="100">₹100</button>
          <button class="amount-btn" data-amount="1000">₹1000</button>
        </div>
        <div class="adjust-buttons">
          <button class="adjust-btn negative" id="minus-10" data-adjust="-10">-₹10</button>
          <button class="adjust-btn negative" id="minus-5" data-adjust="-5">-₹5</button>
          <button class="adjust-btn negative" id="minus-2" data-adjust="-2">-₹2</button>
          <button class="adjust-btn positive" id="plus-2" data-adjust="2">+₹2</button>
          <button class="adjust-btn positive" id="plus-5" data-adjust="5">+₹5</button>
          <button class="adjust-btn positive" id="plus-10" data-adjust="10">+₹10</button>
        </div>
      </div>

      <div class="multiplier-section">
        <div class="section-title"><i class="fas fa-bolt"></i> Multiplier</div>
        <div class="multiplier-grid">
          <button class="multiplier-btn" data-multiplier="1">×1</button>
          <button class="multiplier-btn" data-multiplier="5">×5</button>
          <button class="multiplier-btn" data-multiplier="10">×10</button>
          <button class="multiplier-btn" data-multiplier="20">×20</button>
          <button class="multiplier-btn" data-multiplier="50">×50</button>
          <button class="multiplier-btn" data-multiplier="100">×100</button>
        </div>
      </div>

      <div class="quantity-section">
        <div class="section-title"><i class="fas fa-calculator"></i> Quantity</div>
        <div class="quantity-controls">
          <button class="quantity-btn" id="dec-quantity">-</button>
          <input type="number" class="quantity-input" id="quantity" min="1" value="1" />
          <button class="quantity-btn" id="inc-quantity">+</button>
        </div>
      </div>

      <div class="bet-summary">
        <div class="total-amount">₹<span id="total-bet">1.00</span></div>
      </div>

      <div class="modal-buttons">
        <button class="modal-btn cancel-btn" id="cancel-bet"><i class="fas fa-times"></i> Cancel</button>
        <button class="modal-btn confirm-btn" id="confirm-bet"><i class="fas fa-check"></i> Place Bet</button>
      </div>
    </div>

    <!-- Rules Modal -->
    <div class="rules-modal" id="rules-modal">
      <div class="rules-content">
        <button class="close-rules" id="close-rules">
          <i class="fas fa-times"></i>
        </button>
        <h2 class="rules-title">WinGO Game Rules</h2>

        <div class="rules-section">
          <h3 class="section-header"><i class="fas fa-dice"></i> Game Overview</h3>
          <ul class="rules-list">
            <li>WinGO is a number betting game where players bet on whether a randomly generated number (0-9) will be in the <span class="highlight">BIG (5-9)</span> or <span class="highlight">SMALL (0-4)</span> range</li>
            <li>Each round lasts 30 seconds, after which a random number is generated</li>
            <li>Players can place multiple bets during each round</li>
          </ul>
        </div>

        <div class="rules-section">
          <h3 class="section-header"><i class="fas fa-coins"></i> Betting Rules</h3>
          <ul class="rules-list">
            <li><span class="highlight">Base Amount:</span> Select ₹1, ₹10, ₹100, or ₹1000 as your base bet</li>
            <li><span class="highlight">Multiplier:</span> Multiply your base amount (×1 to ×100)</li>
            <li><span class="highlight">Quantity:</span> Place multiple identical bets at once</li>
            <li>Total Bet = Base Amount × Multiplier × Quantity</li>
          </ul>
        </div>

        <div class="rules-section">
          <h3 class="section-header"><i class="fas fa-trophy"></i> Winning & Payouts</h3>
          <ul class="rules-list">
            <li>If you bet on BIG and the number is 5-9, you win!</li>
            <li>If you bet on SMALL and the number is 0-4, you win!</li>
            <li>Winning bets pay out at <span class="highlight">1.96×</span> the bet amount</li>
            <li>The dealer takes a <span class="highlight">2% fee</span> on all winning bets</li>
            <li>Example: A ₹100 winning bet pays ₹196 (₹100 × 1.96), with ₹4 fee to dealer</li>
          </ul>
        </div>

        <div class="rules-section">
          <h3 class="section-header"><i class="fas fa-landmark"></i> Dealer System</h3>
          <ul class="rules-list">
            <li>
              The dealer collects:
              <ul>
                <li><span class="highlight">2% fee</span> on all winning bets</li>
                <li><span class="highlight">Entire amount</span> of losing bets</li>
              </ul>
            </li>
            <li>The dealer pays out <span class="highlight">1.96×</span> the bet amount on winning bets</li>
            <li>Dealer balance can go <span class="negative">negative</span> if payouts exceed collected fees and losing bets</li>
            <li>This creates a realistic casino experience where the dealer can lose money in a round</li>
          </ul>
        </div>

        <div class="rules-section">
          <h3 class="section-header"><i class="fas fa-chart-line"></i> Optimization</h3>
          <ul class="rules-list">
            <li>Optimized for smooth gameplay with efficient JavaScript calculations</li>
            <li>Visual enhancements for better user experience</li>
            <li>
              Future optimizations could include:
              <ul>
                <li>Multi-language support (Hindi, Spanish, Chinese, etc.)</li>
                <li>Sound effects and animations</li>
                <li>Player statistics and leaderboards</li>
                <li>Mobile app development</li>
              </ul>
            </li>
          </ul>
        </div>

        <!-- Sound Toggle Inside Rules Modal -->
        <div class="sound-toggle-container">
          <div class="sound-toggle" id="sound-toggle">
            <i class="fas fa-volume-up"></i>
            <span>Sound ON</span>
          </div>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Game configuration
        const config = {
          startingWallet: 5000,
          feePercentage: 0.02,
          roundDuration: 30,
          payoutMultiplier: 1.96
        };

        // Game state
        const gameState = {
          wallet: config.startingWallet,
          dealerEarnings: 0,
          timer: config.roundDuration,
          currentBets: [],
          myHistory: [],
          gameHistory: [],
          round: 1,
          result: null,
          gameActive: true,
          baseAmount: 1,
          multiplier: 1,
          quantity: 1,
          currentBetType: null,
          soundEnabled: false,
          extraAdjustment: 0
        };

        // DOM elements
        const elements = {
          timer: document.getElementById("timer"),
          walletAmount: document.getElementById("wallet-amount"),
          dealerAmount: document.getElementById("dealer-amount"),
          bigBtn: document.getElementById("big-btn"),
          smallBtn: document.getElementById("small-btn"),
          bettingModal: document.getElementById("betting-modal"),
          closeModal: document.getElementById("close-modal"),
          modalBetType: document.getElementById("modal-bet-type"),
          totalBet: document.getElementById("total-bet"),
          amountBtns: document.querySelectorAll(".amount-btn"),
          multiplierBtns: document.querySelectorAll(".multiplier-btn"),
          decQuantity: document.getElementById("dec-quantity"),
          incQuantity: document.getElementById("inc-quantity"),
          quantityInput: document.getElementById("quantity"),
          cancelBet: document.getElementById("cancel-bet"),
          confirmBet: document.getElementById("confirm-bet"),
          gameHistory: document.getElementById("game-history"),
          playerHistory: document.getElementById("player-history"),
          mobileGameHistory: document.getElementById("mobile-game-history"),
          mobilePlayerHistory: document.getElementById("mobile-player-history"),
          toast: document.getElementById("toast"),
          infoBtn: document.getElementById("info-btn"),
          rulesModal: document.getElementById("rules-modal"),
          closeRules: document.getElementById("close-rules"),
          timerBtns: document.querySelectorAll(".timer-btn"),
          adjustBtns: document.querySelectorAll(".adjust-btn"),
          detailTooltip: document.getElementById("detail-tooltip"),
          tooltipRound: document.getElementById("tooltip-round"),
          tooltipType: document.getElementById("tooltip-type"),
          tooltipAmount: document.getElementById("tooltip-amount"),
          tooltipOutcome: document.getElementById("tooltip-outcome"),
          tooltipPayout: document.getElementById("tooltip-payout"),
          tooltipFee: document.getElementById("tooltip-fee"),
          tooltipProfit: document.getElementById("tooltip-profit"),
          soundToggle: document.getElementById("sound-toggle"),
          carouselInner: document.getElementById("carousel-inner"),
          carouselDots: document.querySelectorAll(".carousel-dot")
        };

        // Timer interval variable
        let timerInterval = null;
        // Tooltip timeout
        let tooltipTimeout;

        // Initialize game
        function initGame() {
          generateInitialGameHistory();
          updateUI();
          startTimer();
          setupEventListeners();
          activateDefaultButtons();
          updateSoundToggleUI();

          // Setup carousel navigation
          setupCarousel();
        }

        // Generate initial game history
        function generateInitialGameHistory() {
          for (let i = 1; i <= 10; i++) {
            const resultNumber = Math.floor(Math.random() * 10);
            gameState.gameHistory.push({
              round: i,
              number: resultNumber
            });
          }
          // Set current round to 11
          gameState.round = 11;
          updateGameHistory();
        }

        // Update all UI elements
        function updateUI() {
          updateWallet();
          updateDealerBalance();
          updateTimer();
          updateGameHistory();
          updatePlayerHistory();
        }

        // Update wallet display
        function updateWallet() {
          elements.walletAmount.innerHTML = `₹${gameState.wallet.toLocaleString("en-IN", { minimumFractionDigits: 2, maximumFractionDigits: 2 })}<div class="tooltip">Double click to add funds</div>`;
        }

        // Update dealer balance
        function updateDealerBalance() {
          const dealerAmount = gameState.dealerEarnings;
          elements.dealerAmount.textContent = dealerAmount >= 0 ? `₹${dealerAmount.toLocaleString("en-IN", { minimumFractionDigits: 2, maximumFractionDigits: 2 })}` : `-₹${Math.abs(dealerAmount).toLocaleString("en-IN", { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
          elements.dealerAmount.className = dealerAmount >= 0 ? "dealer-amount dealer-positive" : "dealer-amount dealer-negative";
        }

        // Update timer display
        function updateTimer() {
          const minutes = Math.floor(gameState.timer / 60)
            .toString()
            .padStart(2, "0");
          const seconds = (gameState.timer % 60).toString().padStart(2, "0");
          elements.timer.textContent = `${minutes}:${seconds}`;

          if (gameState.timer <= 10) {
            elements.timer.classList.add("timer-critical");
          } else {
            elements.timer.classList.remove("timer-critical");
          }
        }

        // Update game history display
        function updateGameHistory() {
          if (gameState.gameHistory.length === 0) {
            elements.gameHistory.innerHTML = elements.mobileGameHistory.innerHTML = '<div class="empty-history">No game history yet</div>';
            return;
          }

          let historyHTML = "";
          for (let i = gameState.gameHistory.length - 1; i >= 0; i--) {
            const item = gameState.gameHistory[i];
            const isNew = i === gameState.gameHistory.length - 1;

            historyHTML += `<div class="history-row ${isNew ? "new-entry" : ""}" data-round="${item.round}" data-number="${item.number}">
                        <div class="round-label">Round ${item.round}</div>
                        <div class="numbers-row">`;

            for (let num = 0; num <= 9; num++) {
              const isWin = num === item.number;
              const isBig = num >= 5;
              const winClass = isWin ? (isBig ? "win big" : "win small") : "";
              historyHTML += `<div class="number-cell ${winClass}">${num}</div>`;
            }

            historyHTML += `</div></div>`;
          }

          elements.gameHistory.innerHTML = historyHTML;
          elements.mobileGameHistory.innerHTML = historyHTML;
        }

        // Update player history
        function updatePlayerHistory() {
          if (gameState.myHistory.length === 0) {
            elements.playerHistory.innerHTML = elements.mobilePlayerHistory.innerHTML = '<div class="empty-history">No bets placed yet</div>';
            return;
          }

          let historyHTML = "";
          for (let i = gameState.myHistory.length - 1; i >= 0; i--) {
            const item = gameState.myHistory[i];
            const statusClass = item.outcome === "pending" ? "status-pending" : item.outcome === "win" ? "status-win" : "status-loss";
            const isNew = i === gameState.myHistory.length - 1;
            let statusText = "";

            if (item.outcome === "win") {
              const payout = Math.floor(item.amount * config.payoutMultiplier);
              statusText = `+₹${payout.toLocaleString("en-IN", { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            } else if (item.outcome === "pending") {
              statusText = "Pending";
            } else {
              statusText = "Failed";
            }

            historyHTML += `<div class="player-history-item ${isNew ? "new-entry" : ""}"
                         data-round="${item.round}" data-type="${item.type}" data-amount="${item.amount}" data-outcome="${item.outcome}">
                        <div class="history-info">
                            <div class="history-type">${item.type}</div>
                            <div class="history-amount">₹${item.amount.toLocaleString("en-IN", { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                        </div>
                        <div class="history-status ${statusClass}">${statusText}</div>
                    </div>`;
          }

          elements.playerHistory.innerHTML = historyHTML;
          elements.mobilePlayerHistory.innerHTML = historyHTML;
        }

        // Start the game timer
        function startTimer() {
          clearInterval(timerInterval);

          timerInterval = setInterval(() => {
            gameState.timer--;

            if (gameState.timer <= 0) {
              endRound();
            } else {
              updateTimer();
            }
          }, 1000);
        }

        // End the current round
        function endRound() {
          clearInterval(timerInterval);
          gameState.gameActive = false;

          if (gameState.soundEnabled) {
            playSound(440, 200); // Play end sound
          }

          // Generate random number (0-9)
          const resultNumber = Math.floor(Math.random() * 10);
          gameState.result = resultNumber;

          // Add to game history
          gameState.gameHistory.push({
            round: gameState.round,
            number: resultNumber
          });

          // Process all bets
          gameState.currentBets.forEach((bet) => {
            const isWin = (bet.type === "big" && resultNumber >= 5) || (bet.type === "small" && resultNumber <= 4);
            const betIndex = gameState.myHistory.findIndex((b) => b.amount === bet.amount && b.type === bet.type && b.round === gameState.round && b.outcome === "pending");

            if (betIndex !== -1) {
              gameState.myHistory[betIndex].outcome = isWin ? "win" : "loss";
            }

            if (isWin) {
              const payout = Math.floor(bet.amount * config.payoutMultiplier);
              gameState.wallet += payout;
              const dealerFee = bet.amount * config.feePercentage;
              gameState.dealerEarnings -= payout - bet.amount;
            } else {
              gameState.dealerEarnings += bet.amount;
            }
          });

          // Clear current bets
          gameState.currentBets = [];

          // Start next round
          gameState.round++;
          gameState.timer = config.roundDuration;
          gameState.gameActive = true;
          startTimer();
          updateUI();
        }

        // Reset betting modal
        function resetBettingModal() {
          gameState.baseAmount = 1;
          gameState.multiplier = 1;
          gameState.quantity = 1;
          gameState.extraAdjustment = 0;
          elements.quantityInput.value = 1;
          updateBetSummary();
        }

        // Open betting modal
        function openBetModal(type) {
          if (!gameState.gameActive) {
            showToast("Please wait for the next round to start!");
            return;
          }

          gameState.currentBetType = type;
          elements.modalBetType.textContent = `Select ${type.charAt(0).toUpperCase() + type.slice(1)}`;
          resetBettingModal();
          activateDefaultButtons();
          elements.bettingModal.classList.add("modal-open");
        }

        // Activate default buttons
        function activateDefaultButtons() {
          elements.amountBtns.forEach((btn) => btn.classList.remove("active"));
          elements.multiplierBtns.forEach((btn) => btn.classList.remove("active"));
          elements.timerBtns[1].classList.add("active");
          elements.amountBtns[0].classList.add("active");
          elements.multiplierBtns[0].classList.add("active");
        }

        // Update bet summary display
        function updateBetSummary() {
          const baseAmount = gameState.baseAmount;
          const multiplier = gameState.multiplier;
          const quantity = gameState.quantity;
          const extraAdjustment = gameState.extraAdjustment;

          const totalBet = baseAmount * multiplier * quantity + extraAdjustment;
          elements.totalBet.textContent = totalBet.toLocaleString("en-IN", {
            maximumFractionDigits: 2,
            minimumFractionDigits: 2
          });
        }

        // Place a bet
        function placeBet() {
          const baseAmount = gameState.baseAmount;
          const multiplier = gameState.multiplier;
          const quantity = gameState.quantity;
          const extraAdjustment = gameState.extraAdjustment;

          const totalBet = baseAmount * multiplier * quantity + extraAdjustment;

          if (totalBet < 1) {
            showToast("Minimum bet is ₹1");
            return;
          }

          if (totalBet > gameState.wallet) {
            showToast("You do not have enough balance");
            return;
          }

          gameState.wallet -= totalBet;
          gameState.currentBets.push({
            type: gameState.currentBetType,
            amount: totalBet,
            round: gameState.round
          });

          gameState.myHistory.push({
            type: gameState.currentBetType,
            amount: totalBet,
            outcome: "pending",
            round: gameState.round
          });

          elements.bettingModal.classList.remove("modal-open");
          resetBettingModal();
          updatePlayerHistory();
          showToast(`Bet placed: ₹${totalBet.toLocaleString("en-IN", { minimumFractionDigits: 2, maximumFractionDigits: 2 })} on ${gameState.currentBetType}`);
        }

        // Add funds to wallet
        function addFunds() {
          const amount = prompt("Enter amount to add:", "1000");

          if (amount === null) return;

          const amountNum = parseInt(amount);

          if (isNaN(amountNum)) {
            showToast("Please enter a valid number");
            return;
          }

          if (amountNum < 1) {
            showToast("Amount must be at least ₹1");
            return;
          }

          gameState.wallet += amountNum;
          updateUI();
          showToast(`Added ₹${amountNum.toLocaleString("en-IN", { minimumFractionDigits: 2, maximumFractionDigits: 2 })} to your wallet`);
        }

        // Show toast notification
        function showToast(message) {
          elements.toast.textContent = message;
          elements.toast.classList.add("show");

          setTimeout(() => {
            elements.toast.classList.remove("show");
          }, 3000);
        }

        // Play sound effect
        function playSound(frequency, duration) {
          try {
            const context = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = context.createOscillator();
            oscillator.type = "sine";
            oscillator.frequency.setValueAtTime(frequency, context.currentTime);
            oscillator.connect(context.destination);
            oscillator.start();
            setTimeout(() => oscillator.stop(), duration);
          } catch (e) {
            console.log("Audio not supported in this environment");
          }
        }

        // Update sound toggle UI
        function updateSoundToggleUI() {
          if (gameState.soundEnabled) {
            elements.soundToggle.innerHTML = '<i class="fas fa-volume-up"></i><span>Sound ON</span>';
            elements.soundToggle.classList.add("active");
          } else {
            elements.soundToggle.innerHTML = '<i class="fas fa-volume-mute"></i><span>Sound OFF</span>';
            elements.soundToggle.classList.remove("active");
          }
        }

        // Toggle sound on/off
        function toggleSound() {
          gameState.soundEnabled = !gameState.soundEnabled;
          localStorage.setItem("wingo_sound_enabled", gameState.soundEnabled);
          updateSoundToggleUI();

          if (gameState.soundEnabled) {
            playSound(330, 100); // Play confirmation sound
          }
        }

        // Setup carousel navigation
        function setupCarousel() {
          elements.carouselDots.forEach((dot) => {
            dot.addEventListener("click", () => {
              const index = parseInt(dot.dataset.index);
              scrollCarousel(index);
            });
          });
        }

        // Scroll carousel to specific slide
        function scrollCarousel(index) {
          const scrollPosition = index * elements.carouselInner.offsetWidth;
          elements.carouselInner.scrollTo({
            left: scrollPosition,
            behavior: "smooth"
          });

          // Update active dot
          elements.carouselDots.forEach((dot, i) => {
            dot.classList.toggle("active", i === index);
          });
        }

        // Set up event listeners
        function setupEventListeners() {
          // Bet buttons
          elements.bigBtn.addEventListener("click", () => openBetModal("big"));
          elements.smallBtn.addEventListener("click", () => openBetModal("small"));

          // Modal buttons
          elements.closeModal.addEventListener("click", () => {
            closeModal();
          });

          elements.cancelBet.addEventListener("click", () => {
            closeModal();
          });

          elements.confirmBet.addEventListener("click", placeBet);

          // Close modal when clicking outside
          elements.bettingModal.addEventListener("click", function (e) {
            if (e.target === this) {
              closeModal();
            }
          });

          // Close modal function
          function closeModal() {
            elements.bettingModal.classList.remove("modal-open");
            resetBettingModal();
          }

          // Amount buttons
          elements.amountBtns.forEach((btn) => {
            btn.addEventListener("click", () => {
              elements.amountBtns.forEach((b) => b.classList.remove("active"));
              btn.classList.add("active");
              gameState.baseAmount = parseInt(btn.dataset.amount);
              gameState.extraAdjustment = 0;
              updateBetSummary();
            });
          });

          // Adjust buttons - fixed calculation
          elements.adjustBtns.forEach((btn) => {
            btn.addEventListener("click", () => {
              const adjustment = parseFloat(btn.dataset.adjust);
              gameState.extraAdjustment += adjustment;
              updateBetSummary();
            });
          });

          // Multiplier buttons
          elements.multiplierBtns.forEach((btn) => {
            btn.addEventListener("click", () => {
              elements.multiplierBtns.forEach((b) => b.classList.remove("active"));
              btn.classList.add("active");
              gameState.multiplier = parseInt(btn.dataset.multiplier);
              gameState.extraAdjustment = 0;
              updateBetSummary();
            });
          });

          // Quantity input
          elements.quantityInput.addEventListener("change", () => {
            const val = parseInt(elements.quantityInput.value) || 1;
            gameState.quantity = Math.max(1, val);
            gameState.extraAdjustment = 0;
            elements.quantityInput.value = gameState.quantity;
            updateBetSummary();
          });

          // Timer buttons
          elements.timerBtns.forEach((btn) => {
            btn.addEventListener("click", (e) => {
              const seconds = parseInt(e.target.dataset.time);
              config.roundDuration = seconds;
              gameState.timer = seconds;
              updateTimer();
              elements.timerBtns.forEach((b) => b.classList.remove("active"));
              e.target.classList.add("active");
            });
          });

          // Add funds by double-clicking wallet
          elements.walletAmount.addEventListener("dblclick", addFunds);

          // Rules modal
          elements.infoBtn.addEventListener("click", () => {
            elements.rulesModal.classList.add("show");
          });

          elements.closeRules.addEventListener("click", () => {
            elements.rulesModal.classList.remove("show");
          });

          elements.rulesModal.addEventListener("click", (e) => {
            if (e.target === elements.rulesModal) {
              elements.rulesModal.classList.remove("show");
            }
          });

          // Quantity buttons
          elements.incQuantity.addEventListener("click", () => {
            gameState.quantity++;
            gameState.extraAdjustment = 0;
            elements.quantityInput.value = gameState.quantity;
            updateBetSummary();
          });

          elements.decQuantity.addEventListener("click", () => {
            if (gameState.quantity > 1) {
              gameState.quantity--;
              gameState.extraAdjustment = 0;
              elements.quantityInput.value = gameState.quantity;
              updateBetSummary();
            }
          });

          // History hover events
          document.addEventListener("mouseover", (e) => {
            const historyItem = e.target.closest(".history-row, .player-history-item");
            if (historyItem && historyItem.dataset.round) {
              showBetDetails(historyItem, e);
            }
          });

          document.addEventListener("mouseout", hideBetDetails);

          // Sound toggle
          elements.soundToggle.addEventListener("click", toggleSound);
        }

        // Show bet details tooltip
        function showBetDetails(item, event) {
          clearTimeout(tooltipTimeout);

          // Position tooltip to stay within viewport
          let left = event.clientX + 10;
          let top = event.clientY - 10;

          // Check if tooltip would go off the right edge
          const tooltipWidth = 280;
          if (left + tooltipWidth > window.innerWidth) {
            left = window.innerWidth - tooltipWidth - 10;
          }

          // Check if tooltip would go off the bottom edge
          const tooltipHeight = 250;
          if (top + tooltipHeight > window.innerHeight) {
            top = window.innerHeight - tooltipHeight - 10;
          }

          elements.detailTooltip.style.left = `${left}px`;
          elements.detailTooltip.style.top = `${top}px`;

          const round = item.dataset.round;
          const type = item.dataset.type;
          const amount = parseFloat(item.dataset.amount);
          const outcome = item.dataset.outcome;

          // Calculate details
          const payout = outcome === "win" ? Math.floor(amount * config.payoutMultiplier) : 0;
          const fee = outcome === "win" ? amount * config.feePercentage : 0;
          const profit = outcome === "win" ? payout - amount : -amount;

          // Update tooltip
          elements.tooltipRound.textContent = round;
          elements.tooltipType.textContent = type.toUpperCase();
          elements.tooltipAmount.textContent = `₹${amount.toLocaleString("en-IN", { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
          elements.tooltipOutcome.textContent = outcome.charAt(0).toUpperCase() + outcome.slice(1);
          elements.tooltipOutcome.className = outcome === "win" ? "tooltip-value positive" : outcome === "loss" ? "tooltip-value negative" : "tooltip-value";
          elements.tooltipPayout.textContent = `₹${payout.toLocaleString("en-IN", { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
          elements.tooltipFee.textContent = `₹${fee.toLocaleString("en-IN", { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
          elements.tooltipProfit.textContent = `₹${profit.toLocaleString("en-IN", { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
          elements.tooltipProfit.className = profit >= 0 ? "tooltip-value positive" : "tooltip-value negative";

          elements.detailTooltip.classList.add("show");
        }

        // Hide bet details tooltip
        function hideBetDetails() {
          clearTimeout(tooltipTimeout);
          tooltipTimeout = setTimeout(() => {
            elements.detailTooltip.classList.remove("show");
          }, 200);
        }

        // Start the game
        initGame();
      });
    </script>
  </body>
</html>
